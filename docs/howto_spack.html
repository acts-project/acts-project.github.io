<!-- HTML header for doxygen 1.12.0-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.15.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ACTS: Building with Spack</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script>
MathJax = {
  tex: {
    inlineMath: {'[+]': [['$', '$']]}
  },
};
</script>
<script id="MathJax-script" async
          src="https://cdn.jsdelivr.net/npm/mathjax@4/tex-mml-chtml.js">
</script>
<!-- <script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
 -->
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
<script type="text/javascript" src="doxygen-awesome-interactive-toc.js"></script>
<script type="text/javascript">
    DoxygenAwesomeDarkModeToggle.init()
    DoxygenAwesomeParagraphLink.init()
    DoxygenAwesomeInteractiveToc.init()
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="acts_logo_colored.svg"/></td>
  <td id="projectalign">
   <div id="projectname">ACTS
   </div>
   <div id="projectbrief">Experiment-independent tracking</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.15.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('howto_spack.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Building with Spack </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Guide to building ACTS with Spack.</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md55"></a>
Building with Spack</h1>
<p><a href="https://spack.io/">Spack</a> is a package manager designed to handle software used in scientific computing, including computing in high-energy physics. The Spack package manager can be used to more easily install ACTS' dependencies. Builds using Spack are not officially supported. In order to start using Spack, follow the instructions on the <a href="https://spack.readthedocs.io/en/latest/getting_started.html">official Spack documentation</a>.</p>
<h2 class="doxsection"><a class="anchor" id="autotoc_md56"></a>
Installing dependencies</h2>
<p>Once Spack has been installed, we are ready to create a development environment; for example:</p>
<div class="fragment"><div class="line">spack env create acts</div>
</div><!-- fragment --><p>This new environment can then be activated and deactivated as follows:</p>
<div class="fragment"><div class="line">spack env activate acts</div>
<div class="line">despacktivate</div>
</div><!-- fragment --><dl class="section remark"><dt>Remarks</dt><dd>The creation of a Spack environment is persistent, i.e. you should only need to create your environment once. The activation of the environment, on the other hand, affects only your current shell. As a result, you will need to activate the environment every time you open a new shell.</dd></dl>
<p>With the Spack environment activated, you are ready to install ACTS' dependencies. You can either do this manually, or you can rely on Spack's definition of how to do this. To use the Spack definition, execute the following command (tuned for ACTS version 36.1.0; make sure you update the version number to match the version of ACTS you want to build):</p>
<div class="fragment"><div class="line">spack install --add --only dependencies &quot;acts@36.1.0&quot;</div>
</div><!-- fragment --><p>This specification will suffice to build the core ACTS library. If you want to build ACTS plugins, you will need to add additional <em>variants</em>; the following is a spec which can be used to build ACTS and all its plugins:</p>
<div class="fragment"><div class="line">spack install --add --only dependencies &quot;acts@36.1.0+tgeo+geomodel+podio+edm4hep+examples+odd+fatras+json+dd4hep+geant4+fatras_geant4+hepmc3+pythia8+python+svg+traccc&quot;</div>
</div><!-- fragment --><p>The string starting with <span class="tt">acts</span> in the commands above is the so-called <em>spec</em>, and it consists of three parts. The first part is the name of the package, which is <span class="tt">acts</span>. The second part is the version of the package, in this case <span class="tt">36.1.0</span>; Spack will pull in a set of dependencies suitable for that given version, so it is recommended to tune the version number to match the version of ACTS you want to build. The final part is a series of variants, marked with the <span class="tt">+</span> symbol. The command above allows you to build virtually all components of ACTS, but it also pulls in a large number of dependencies. You can remove variants you do not need in order to speed up the Spack build.</p>
<p>Once Spack has concretized and installed the ACTS dependencies, you can build ACTS as normal using CMake.</p>
<h3 class="doxsection"><a class="anchor" id="spack_running_with_dependencies"></a>
Running with dependencies</h3>
<p>In order to run code depending on ACTS dependencies such as DD4hep, you may need to run an additional shell script when you activate your Spack environment. This shell script is called <span class="tt">this_acts_withdeps.sh</span> and resides in your ACTS build directory:</p>
<div class="fragment"><div class="line">source &lt;build directory&gt;/this_acts_withdeps.sh</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md57"></a>
Build caches</h2>
<p>Work on build caches for ACTS is in progress.</p>
<h2 class="doxsection"><a class="anchor" id="autotoc_md58"></a>
Support</h2>
<p>Spack support is experimental and not officially supported. Because ACTS' dependencies are constantly changing, it is possible that Spack's database may at times be out of date. If you encounter any problems using Spack to build ACTS, unofficial support is available in the <a href="https://mattermost.web.cern.ch/acts/channels/spack">Spack</a> channel on the ACTS Mattermost.</p>
<h2 class="doxsection"><a class="anchor" id="autotoc_md59"></a>
Troubleshooting</h2>
<p>The following are some common problems you may encounter using Spack to build ACTS.</p>
<h3 class="doxsection"><a class="anchor" id="autotoc_md60"></a>
DD4hep not finding factories</h3>
<p>If you run into an error like the following, DD4hep is failing to find the object files required to parse some its required factories. Remember to initialize the ACTS dependencies as described in <a class="el" href="#spack_running_with_dependencies">&quot;Running with dependencies&quot;</a>:</p>
<div class="fragment"><div class="line">dd4hep: Failed to locate plugin to interprete files of type &quot;lccdd&quot; - no factory:lccdd_XML_reader.</div>
<div class="line">        No factory with name Create(lccdd_XML_reader) for type lccdd_XML_reader found.</div>
<div class="line">        Please check library load path and/or plugin factory name.</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.15.0 </li>
  </ul>
</div>
</body>
</html>
