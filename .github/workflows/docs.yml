name: Deploy GitHub Pages from upstream artifact

on:
  repository_dispatch:
    types: [ deploy_docs ]

permissions:
  contents: write   # needed to push to the Pages branch (e.g. gh-pages)

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
     - name: Checkout ğŸ›ï¸
       uses: actions/checkout@v6

     - uses: actions/download-artifact@v4
       with:
        path: html
        repository: '${{ github.event.client_payload.source_repo }}'
        artifact-ids: '${{ github.event.client_payload.artifact_id }}'
        run-id: ${{ github.event.client_payload.run_id }}
        github-token: ${{ secrets.CROSS_REPO_ARTIFACT_READ }}

      # @TODO: Replace this with versioned deployments
     - name: Deploy ğŸš€
       uses: JamesIves/github-pages-deploy-action@v4
       with:
         folder: html
         target-folder: public
